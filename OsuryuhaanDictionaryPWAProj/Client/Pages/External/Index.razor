@page "/"
@inject IWordService WordService;
<PageTitle>Dashboard</PageTitle>

<link rel="stylesheet" href="~/css/app.css"/>
<div class="bd-main-interface">
    <div class="interface-header container-fluid text-end bg-light-gray">
         <div class="display-6 fw-semibold me-4">Dashboard</div>
    </div>
    <div class="bd-interface-body justify-content-md-center">
        <!--Word of the day and statistics of how many words exist of each category.-->
        <div class="container-fluid" id="top-section">
            <div class="row flex-row pb-4">
                <div class="col-lg-4" id="word-of-the-day">
                    <div class="card m-4 text-center text-muted h-100">
                        <div class="card-header">
                            <h2>Word of the Day</h2>
                        </div>
                        <div class="card-body">
                            <div id="new-word">
                                <p class="display-5">@WordService.WordOfTheDay?.Name</p>
                                <p class="display-6">@WordService.WordOfTheDay?.Definition</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-8">
                    <div class="card m-4 text-center text-muted h-100">
                        <div class="card-header">
                            <h2>Stats</h2>
                        </div>
                        <div class="card-body">
                            <!--Show all Stats Here-->
                        </div>
                    </div>
                </div>
            </div>
            <div class="row-lg-auto pt-2">
                <div class="card m-4 text-center text-muted" style="max-height: 35rem;">
                    <div class="card-header">
                        <h4 class="float-start">Recent Searches</h4>
                    </div>
                    <div class="card-body" style="overflow-y: auto;">
                        <div class="list-group list-group-flush" id="search-list">
                            @{
                                for(int i =0; i < WordService.Words.Count; i++)
                                {
                                    <button class="list-group-item text-start search-entry">
                                        <p class="text-start ms-3">@WordService.Words[i].Name</p>
                                    </button>
                                }
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    private const int MaxRecentSearchCount = 15;
    protected override async Task OnInitializedAsync()
    {
        await Task.Run(() => MainLayout.ChangeHeaderName("Dashboard"));
        
        Task task = WordService.GetWords();
        await task;

        if (task.IsCompletedSuccessfully){
            await WordService.GenerateWordOfTheDay();
            return;
        }
    }
}